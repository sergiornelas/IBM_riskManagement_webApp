{% extends 'base.html' %}

{% block content %}

<script>
   console.log(localStorage.arrayFullServers)
   $(document).ready(function () {
      $("#content").val(localStorage.arrayFullServers);
      $("#exception_type_IDD").val("2");
   });
</script>

<section id="showcase-inner" class="py-5 text-white">
   <div class="container">
      <div class="row text-center">
         <div class="col-md-12">
            <h1 class="display-4">INQUIRY SERVERS</h1>
            <i class="fa fa-clipboard fa-5x" aria-hidden="true"></i>
            <p class="lead">Manage your patches if you have struggles</p>
         </div>
      </div>
   </div>
</section>

<!-- Breadcrumb -->
<section id="bc" class="mt-3">
   <div class="container">
      <nav aria-label="breadcrumb">
         <ol class="breadcrumb">
            <li class="breadcrumb-item">
               <a href="{% url 'dashboard' %}">
                  <i class="fas fa-home"></i> Dashboard </a>
            </li>
            <li class="breadcrumb-item">
               <a href="{% url 'exceptionsBoard' %}">
                  <i class="fas fa-calendar-check"></i> Requests </a>
            </li>
         </ol>
      </nav>
   </div>
</section>

<script>
   //window.dias;
   //var dias;
   var limit
   $(document).ready(function () {
      $.ajax({

         async: false,

         method: "POST",
         data: {
             //limitDay: localStorage.arrayServerPatches
             limitDay: localStorage.arrayFullServers
         },
         url: 'getDaysLimit',
      }).done(function (data) { //ME DEVUELVE LOS OBJETOS ADVIOSORY RELACIONADOS AL SERVER SELECCIONADO
         //console.log(data)
         limit=data;
         return limit;
      });
   });
</script>
   
<script>
   
   console.log(limit);
</script>

<!-- <section id="dashboard" class="py-4"> -->
<div class="container">
   <div style="margin-bottom: 2em; margin-top: 2em;" class="progress">
      <div class="progress-bar progress-bar-striped active" role="progressbar" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100" style="width:100%; ">
      100%
      </div>
    </div>
   <!-- <form role="form" action="" method="post" class="registration-form"> -->
   <div class="form-top">
      <div class="form-top-left">
         <p>What do you want to make an exception?:</p>
      </div>
   </div>
   <form action="{% url 'exclude_server' %}" method="POST">

      <!-- <p id="demo"></p>
            <script>
                document.getElementById("demo").innerHTML=localStorage.arrayFullServers;
            </script> -->

      {% csrf_token %}

      <!-- <input id ="totalServers" type="hidden" name="content" value=localStorage.arrayFullServers> -->
      <input id="content" type="hidden" name="content">

      <input id="exception_type_IDD" type="hidden" name="exception_type">
      <!-- <input type="hidden" name="exception_type" value=2> -->

      <!-- Estos se introducen del modelo de exception -->
      <div class="form-group">
         <label for="title" class="col-form-label">Title:</label>
         <input type="text" name="title" class="form-control" required>
      </div>
      <div class="form-group">
         <label for="justification" class="col-form-label">Action plan:</label>
         <textarea rows="7" name="justification" class="form-control" required></textarea>
      </div>


      <div class="form-group">
         <label for="excludeDate" class="col-form-label">Exclude date:</label>
         <input type="datetime" readonly="readonly" name="exclude_date" class="tail-datetime-field form-control col-md-2" autocomplete="off" required>
         <label for="excludeDate" class="col-md-10 col-form-label">This is defined by major patch criticality</label>
      </div>

      <!--     CALENDAR      -->

      <script type="text/javascript">
         
         var today = new Date();
         var dd = String(today.getDate()).padStart(2, '0');
         var mm = String(today.getMonth() + 1).padStart(2, '0'); //January is 0!
         var yyyy = today.getFullYear();

         today = yyyy + '-' + mm + '-' + dd;        

         document.addEventListener("DOMContentLoaded", function(){
            
            tail.DateTime(".tail-datetime-field", { 
               dateRanges: [
               // Will Disable 05-JAN -> 07-JAN completely
               {
                   //start: new Date(2020, 5, 5),
                   start: today,
                   end: new Date(2020, 5, 30),
                   // days: true                 // This is the default
               }], 
               dateStart: new Date(2018, 0, 5),
               dateBlacklist: false,
               viewDecades: false
            }
            );
         });
         
      </script>

      <!-- FALTA AGREGAR EL ACTION PLAN -->
      <hr>     

      <div class="container">
         <div class="row">
            <div class="col-md-6"> </div>
            <div style="padding-top: 2em;" class="col-md-3">
               <a style="background-color:#D0D0D5"href="{% url 'selectServers' %}" class="btn btn-block">Back</a>
            </div>
            <div style="padding-top: 2em;" class="col-md-3">
               <input style="margin-bottom: 1rem;" type="submit" value="Send" class="btn btn-block btn-secondary" />
            </div>
            
         </div>
      </div>

      <!-- name = database field, value = input value to db -->
   </form>
</div>

{% endblock %}
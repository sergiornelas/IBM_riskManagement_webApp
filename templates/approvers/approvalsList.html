{% extends 'base.html' %}

<!-- comentar el jinja -->
{# {% load humanize %} #}

{% block content %}

<section id="showcase-inner" class="py-5 text-white">
  <div class="container">
    <div class="row text-center">
      <div class="col-md-12">
        <h1 class="display-4">List of exceptions</h1>
        <p class="lead">Lorem ipsum dolor sit, amet consectetur adipisicing elit. Recusandae quas, asperiores eveniet
          vel nostrum magnam voluptatum tempore! Consectetur, id commodi!</p>
      </div>
    </div>
  </div>
</section>

<!-- Breadcrumb -->
<section id="bc" class="mt-3">
  <div class="container">
    <nav aria-label="breadcrumb">
      <ol class="breadcrumb">

        <!-- <li class="breadcrumb-item active"> List of exceptions</li> -->
        <li class="breadcrumb-item">
          <a href="{% url 'approvalsList' %}">
             <i class="fas fa-calendar-check"></i> List of exceptions </a>
       </li>
      </ol>
    </nav>
  </div>
</section>

<section id="dashboard" class="py-4">
  <div class="container">
    {% include 'partials/_alerts.html' %}
    <div class="row">
      <div class="col-md-12">
        <h2 style="margin-bottom: 1em;">Welcome {{ user.username }}</h2>
        {#{% if all %}#}
        {% if excepciones %}
          <table class="table table-striped table-bordered">
            <thead class="table-dark ">
              <tr>
                <th style="text-align:center" scope="col">ID</th>
                <th style="text-align:center" scope="col">Title</th>
                <th style="text-align:center" scope="col">Limit exception date</th>
                <th style="text-align:center" scope="col">Exception type</th>
                <th style="text-align:center" scope="col">Customer name</th>
                <th style="text-align:center" scope="col">Final status</th>
              </tr>
            </thead>
            <tbody>
              {#{% for alias, alias2 in all %}#}
              {% for alias in excepciones %}
                <tr>
                  <td style="text-align:center" >{{ alias.id}}</td>
                  <td style="text-align:center" >{{ alias.title}}</td>
                  <td style="text-align:center" >{{ alias.exclude_date}}</td>

                  {% if alias.exception_type == 1 %}
                    <td style="text-align:center" >Patch</td>
                  {% elif alias.exception_type == 2 %}
                    <td style="text-align:center" >Full server</td>
                  {% else %}
                    <td style="text-align:center" >Unknown</td>
                  {% endif %}
                  <td style="text-align:center" > {{ alias.client}} </td>
                  {#<td style="text-align:center" >{{ alias2.state}}</td>#}
                  {% if alias.state == "Approved" %}
                    <td style="text-align:center; color:green;" ><b>{{ alias.state }}</b></td>
                  {% elif alias.state == "Rejected" %}
                    <td style="text-align:center; color:red;" ><b>{{ alias.state }}</b></td>
                  {% else %}
                    <td style="text-align:center;" >{{ alias.state }}</td>
                  {% endif %}
                  <td style="text-align:center" >
                    <a href="{% url 'approvalDet' alias.id %}" class="btn btn-primary btn-block">More Info</a>
                  </td>
              {% endfor %}
            </tbody>
          </table>
        {% else %}
          <p>You have not exceptions</p>
        {% endif %}
      </div>
    </div>
  </div>
</section>

{% endblock %}